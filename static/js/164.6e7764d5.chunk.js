(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[164],{1059:function(e,t,n){"use strict";n.r(t);var r=n(64),a=n.n(r),i=n(65),c=n(8),s=n(0),o=n(84),u=n(373),l=n(323),d=n(321),m=(n(411),n(69)),p=n(952),b=n(955),f=n(55),j=n(109),h=n.n(j),v=n(943),x=n(354),O=n(301),g=n(1072),y=n(308),w=n(316),_=n(3),N=function(e){var t=e.form,n=e.disabled,r=Object(s.useState)(),o=Object(c.a)(r,2),u=o[0],p=o[1],b=function(e){return Object(_.jsx)("div",{className:"d-flex justify-content-left align-items-center",children:Object(_.jsxs)("div",{className:"d-flex flex-column",children:[Object(_.jsx)("h6",{className:"user-name text-truncate mb-0",children:null===e||void 0===e?void 0:e.phone}),Object(_.jsx)("small",{className:"text-truncate text-muted mb-0",children:null===e||void 0===e?void 0:e.name})]})})},f=function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.autocomplete(t);case 2:return n=e.sent,e.abrupt("return",n.map((function(e){var t=e.id,n=e.name,r=e.email,a=e.phone;return{label:b({id:t,name:n,email:r,phone:a}),value:t,item:{id:t,name:n,email:r,phone:a}}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)(l.a,{children:[Object(_.jsx)(d.a,{sm:"5",children:Object(_.jsxs)(v.a,{children:[Object(_.jsx)(x.a,{for:"user_id",children:"User"}),Object(_.jsx)(m.a,{control:t.control,defaultValue:null,name:"user_id",render:function(e){var r=e.onChange,a=e.value;e.name,e.ref;return Object(_.jsx)(y.a,{isClearable:!0,className:"react-select",classNamePrefix:"select",defaultOptions:!0,isDisabled:n,value:{value:a,label:b(u)},loadOptions:f,cacheOptions:!0,onChange:function(e,n){r(null===e||void 0===e?void 0:e.item.id),function(e,n){n.action,n.removedValue,p(null===e||void 0===e?void 0:e.item),(null===e||void 0===e?void 0:e.item)&&(t.setValue("customer.name",e.item.name),t.setValue("customer.email",e.item.email),t.setValue("customer.phone",e.item.phone))}(e,n)}})}})]})}),Object(_.jsx)(d.a,{sm:"5",children:Object(_.jsxs)(v.a,{children:[Object(_.jsx)(x.a,{for:"title",children:"Title"}),Object(_.jsx)(O.a,{disabled:n,type:"text",id:"title",placeholder:"Add Sms Title",name:"title",innerRef:t.register({required:!0}),invalid:t.errors.subject&&!0})]})}),Object(_.jsx)(d.a,{sm:"2",children:Object(_.jsxs)(v.a,{children:[Object(_.jsx)(x.a,{for:"subject",children:"To All Users"}),Object(_.jsx)(g.a,{id:"to_all",type:"switch",disabled:n,name:"to_all",innerRef:t.register()})]})}),Object(_.jsx)(d.a,{sm:"12",children:Object(_.jsxs)(v.a,{children:[Object(_.jsx)(x.a,{for:"message",children:"Message"}),Object(_.jsx)(O.a,{disabled:n,id:"message",type:"textarea",name:"message",placeholder:"Add Sms Content",innerRef:t.register({required:!1}),invalid:t.errors.message&&!0})]})})]})},C=n(565),S=function(e){var t=e.form,n=e.isCompleted;e.isReorder;return Object(_.jsxs)(p.a,{children:[Object(_.jsx)(b.a,{className:"px-2 pb-0",children:Object(_.jsxs)("div",{className:"d-flex justify-content-between flex-md-row flex-column",children:[Object(_.jsx)("div",{children:Object(_.jsx)("strong",{children:"New Sms "})}),Object(_.jsxs)("div",{children:["Date: ",Object(_.jsx)("span",{className:"invoice-number",children:h()().format("Y-MM-DD")})]})]})}),Object(_.jsx)("hr",{className:"invoice-spacing"}),Object(_.jsx)(b.a,{className:"px-2 pt-0",children:Object(_.jsx)(N,{form:t,disabled:n})}),Object(_.jsx)(b.a,{className:"invoice-padding pt-0 d-flex",children:Object(_.jsxs)(f.a.Ripple,{color:"primary",type:"submit",children:[Object(_.jsx)(C.a,{size:14}),Object(_.jsx)("span",{className:"align-middle ml-25",children:"Send Sms"})]})})]})};n(554),n(424),n(536),t.default=function(){var e=Object(m.b)(),t=Object(m.b)(),n=(t.register,t.errors,t.handleSubmit,t.control,t.setValue,Object(s.useState)(null)),r=Object(c.a)(n,2),p=(r[0],r[1]),b=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{history.push("/category/list")}catch(t){p(null===(n=t.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.errors)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)(s.Fragment,{children:[Object(_.jsx)(o.a,{breadCrumbTitle:"Settings",breadCrumbActive:"Send Sms"}),Object(_.jsx)(u.a,{onSubmit:e.handleSubmit(b),children:Object(_.jsx)(l.a,{children:Object(_.jsx)(d.a,{md:12,sm:12,children:Object(_.jsx)(S,{form:e,isCompleted:!1,isReorder:!0})})})})]})}},169:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n(64),a=n.n(r),i=n(65),c=n(305),s=n.n(c),o=n(179),u=n.n(o)()(s.a),l=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.fire({title:"Are you sure?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, do it!",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-outline-danger ml-1"},buttonsStyling:!1}).then((function(e){e.value&&t()}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.fire({title:"Are you sure want to delete?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-danger ml-1"},buttonsStyling:!1}).then((function(e){e.value&&t()}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},316:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p}));var r=n(2),a=n(64),i=n.n(a),c=n(65),s=(n(85),n(77)),o=n(83),u="user",l={create:function(e){return o.a.create(u,e)},update:function(e,t){return o.a.update(u,e,t)},delete:function(e){return o.a.delete(u,e)},autocomplete:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("".concat(u,"/autocomplete?q=").concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),autocompleteUserForTaxExempt:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("".concat(u,"/autocompleteUserForTaxExempt?q=").concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),autocompleteCashier:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("".concat(u,"/autocompletecashier?q=").concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),autocompleteTaxExempt:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("".concat(u,"/autocompleteTaxExempt?q=").concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),changePassword:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("".concat(u,"/").concat(t,"/change-password"),n);case 2:return r=e.sent,a=r.data,e.abrupt("return",null===a||void 0===a?void 0:a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),verificationEmail:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("".concat(u,"/").concat(t,"/verification-email"));case 2:return n=e.sent,r=n.data,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};function d(e){return Object(o.d)(u,e)}function m(e){var t=Object(o.b)(u,"".concat(u,"/datatable"),e);return t.mutates=Object(r.a)(Object(r.a)({},t.mutates),{},{verificationEmail:l.verificationEmail}),t}function p(e){var t=Object(o.b)(u,"".concat(u,"/employee"),e);return t.mutates=Object(r.a)(Object(r.a)({},t.mutates),{},{verificationEmail:l.verificationEmail}),t}},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n(64),a=n.n(r),i=n(65),c=n(83),s=n(77),o="payment_method",u={create:function(e){return c.a.create(o,e)},update:function(e,t){return c.a.update(o,e,t)},delete:function(e){return c.a.delete(o,e)},index:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("".concat(o));case 2:return t=e.sent,n=t.data,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};function l(e){return Object(c.d)(o,e)}function d(e){return Object(c.b)(o,"".concat(o,"/datatable"),e)}},335:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o}));var r=n(83),a="city",i={create:function(e){return r.a.create(a,e)},update:function(e,t){return r.a.update(a,e,t)},delete:function(e){return r.a.delete(a,e)}};function c(e){return Object(r.d)(a,e)}function s(e){return Object(r.b)(a,"".concat(a,"/datatable"),e)}function o(){return Object(r.e)(a)}},346:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o}));var r=n(83),a="shipping-provider",i={create:function(e){return r.a.create(a,e)},update:function(e,t){return r.a.update(a,e,t)},delete:function(e){return r.a.delete(a,e)}};function c(e){return Object(r.d)(a,e)}function s(e){return Object(r.b)(a,"".concat(a,"/datatable"),e)}function o(){return Object(r.e)(a)}},411:function(e,t,n){"use strict";var r=n(378),a=n(3);t.a=function(e){var t=e.errors;return t?Object(a.jsx)(r.a,{color:"danger",children:Object.keys(t).map((function(e){return Object(a.jsx)("div",{className:"alert-body",children:t[e][0]})}))}):Object(a.jsx)(a.Fragment,{})}},424:function(e,t,n){"use strict";var r=n(8),a=n(952),i=n(943),c=n(953),s=n(1072),o=n(955),u=n(301),l=n(354),d=n(111),m=n(69),p=n(335),b=n(346),f=n(0),j=n(3);t.a=function(e){var t,n,h=e.form,v=(e.isCompleted,e.isMigrated,Object(f.useState)({})),x=Object(r.a)(v,2),O=x[0],g=x[1],y=Object(p.d)().data,w=Object(b.d)().data,_=y.map((function(e){return{label:e.name,value:e.id,cost:e.shipping_cost}})),N=w.map((function(e){return{label:e.name,value:e.id}})),C=h.watch("has_shipping"),S=2===h.watch("city_id");Object(f.useEffect)((function(){S?h.setValue("has_shipping",!1):h.setValue("has_shipping",!0)}),[S]);var k=[{label:"Waiting for shipping",value:"WAITING"},{label:"On The Way",value:"SHIPPED"},{label:"Delivered",value:"DELIVERED"}];return Object(j.jsxs)(a.a,{children:[Object(j.jsx)("div",{style:{width:"100%"},children:Object(j.jsx)(i.a,{children:Object(j.jsx)(m.a,{control:h.control,defaultValue:null,name:"city_id",render:function(e){var t=e.onChange,n=e.value,r=(e.name,e.ref);return Object(j.jsx)(d.a,{className:"react-select",classNamePrefix:"select",value:_.filter((function(e){return e.value===n})),inputRef:r,placeholder:"Select City...",options:_,onChange:function(e){var n;t((null===e||void 0===e?void 0:e.value)||null),n=e,h.setValue("shipping.cost",(null===n||void 0===n?void 0:n.cost)||0)},isClearable:!0})}})})}),Object(j.jsxs)(c.a,{children:["Shipping",Object(j.jsx)(s.a,{id:"order-has-shipping",type:"switch",name:"has_shipping",innerRef:h.register(),onChange:function(e){e.target.checked?O&&(h.setValue("shipping",O.shipping),h.setValue("city_id",O.city),h.setValue("shipping_provider_id",O.shipping_provider)):(g({city:h.getValues("city_id"),shipping_provider:h.getValues("shipping_provider_id"),shipping:{cost:h.getValues("shipping.cost"),address:h.getValues("shipping.address"),status:h.getValues("shipping.status")}}),h.setValue("shipping.cost",null),h.setValue("shipping.address",null),h.setValue("shipping.status",null),h.setValue("city_id",null),h.setValue("shipping_provider_id",null))}})]}),Object(j.jsxs)(o.a,{children:[Object(j.jsx)(i.a,{children:Object(j.jsx)(m.a,{control:h.control,defaultValue:null,name:"shipping_provider_id",render:function(e){var t=e.onChange,n=e.value,r=(e.name,e.ref);return Object(j.jsx)(d.a,{className:"react-select",classNamePrefix:"select",placeholder:"Select Shipping Provider...",value:N.filter((function(e){return e.value===n})),inputRef:r,options:N,onChange:function(e){return t((null===e||void 0===e?void 0:e.value)||null)},isClearable:!0,isDisabled:!C})}})}),Object(j.jsx)(i.a,{children:Object(j.jsx)(u.a,{disabled:!C,type:"textarea",name:"shipping.address",placeholder:"Shipping Address",innerRef:h.register({required:C}),invalid:(null===(t=h.errors.shipping)||void 0===t?void 0:t.address)&&!0})}),Object(j.jsx)(i.a,{children:Object(j.jsx)(u.a,{disabled:!C,type:"number",name:"shipping.cost",placeholder:"Cost",step:"0.1",innerRef:h.register({required:C}),invalid:(null===(n=h.errors.shipping)||void 0===n?void 0:n.cost)&&!0})}),Object(j.jsx)(i.a,{children:Object(j.jsx)(m.a,{control:h.control,defaultValue:"WAITING",name:"shipping.status",render:function(e){var t=e.onChange,n=e.value,r=(e.name,e.ref);return Object(j.jsx)(d.a,{isDisabled:!C,className:"react-select",classNamePrefix:"select",value:k.filter((function(e){return e.value===n})),inputRef:r,options:k,onChange:function(e){return t(null===e||void 0===e?void 0:e.value)}})}})}),Object(j.jsx)(i.a,{children:Object(j.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(j.jsx)(l.a,{className:"mb-0",for:"order-free-shipping",children:"Free Shipping"}),Object(j.jsx)(s.a,{disabled:!C,id:"order-free-shipping",type:"switch",name:"shipping.free",innerRef:h.register()})]})})]})]})}},536:function(e,t,n){"use strict";var r=n(64),a=n.n(r),i=n(65),c=n(8),s=n(1072),o=n(354),u=n(943),l=n(0),d=n(69),m=n(308),p=n(316),b=n(3);t.a=function(e){var t=e.form,n=e.order,r=e.isCompleted,f=e.isMigrated,j=Object(l.useState)(),h=Object(c.a)(j,2),v=h[0],x=h[1],O=t.watch("options.taxed"),g=t.watch("options.tax_exempt"),y=function(e){return Object(b.jsx)("div",{className:"d-flex justify-content-left align-items-center",children:Object(b.jsxs)("div",{className:"d-flex flex-column",children:[Object(b.jsx)("h6",{className:"user-name text-truncate mb-0",children:null===e||void 0===e?void 0:e.name}),Object(b.jsx)("small",{className:"text-truncate text-muted mb-0",children:null===e||void 0===e?void 0:e.email})]})})},w=function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.autocompleteTaxExempt(t);case 2:return n=e.sent,e.abrupt("return",n.map((function(e){var t=e.id,n=e.name,r=e.email,a=e.phone,i=e.identity_number_type,c=e.tax_exempt,s=e.tax_zero,o=e.identity_number;return{label:y({id:t,name:n,email:r,phone:a,identity_number_type:i,tax_exempt:c,tax_zero:s,identity_number:o}),value:t,item:{id:t,name:n,email:r,phone:a,identity_number_type:i,tax_exempt:c,tax_zero:s,identity_number:o}}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){O?t.setValue("options.price_offer",!1):(t.setValue("options.tax_exempt",!1),t.setValue("options.tax_zero",!1)),g||t.setValue("options.tax_zero",!1)}),[O,g]),Object(l.useEffect)((function(){v||x(null===n||void 0===n?void 0:n.taxExempt)}),[n]);return Object(b.jsxs)("div",{className:"mt-1",children:[Object(b.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(b.jsx)(s.a,{id:"order-taxed",type:"switch",disabled:!!(null===n||void 0===n?void 0:n.tax_number)||r||f,name:"options.taxed",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"order-taxed",children:Object(b.jsx)("strong",{children:"\u0641\u0627\u062a\u0648\u0631\u0629 \u0636\u0631\u064a\u0628\u064a\u0629"})})]}),Object(b.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(b.jsx)(s.a,{disabled:!O||r||f,id:"order-tax-exempt",type:"switch",name:"options.tax_exempt",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"order-tax-exempt",children:Object(b.jsx)("strong",{children:"\u0645\u0639\u0641\u064a \u0645\u0646 \u0627\u0644\u0636\u0631\u064a\u0628\u0629"})})]}),Object(b.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(b.jsx)(s.a,{disabled:!O||r||!g||f,id:"order-tax-zero",type:"switch",name:"options.tax_zero",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"order-tax-zero",children:Object(b.jsx)("strong",{children:"\u0645\u0639\u0641\u064a \u0628\u0646\u0633\u0628\u0629 \u0627\u0644\u0635\u0641\u0631"})})]}),Object(b.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(b.jsx)(s.a,{disabled:r||f,id:"order-dept",type:"switch",name:"options.dept",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"order-dept",children:Object(b.jsx)("strong",{children:"\u0641\u0627\u062a\u0648\u0631\u0629 \u0630\u0645\u0645"})})]}),Object(b.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(b.jsx)(s.a,{disabled:O||r||f,id:"order-price-offer",type:"switch",name:"options.price_offer",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"order-price-offer",children:Object(b.jsx)("strong",{children:"\u0639\u0631\u0636 \u0633\u0639\u0631"})})]}),Object(b.jsxs)("div",{className:"d-flex justify-content-between mt-1",children:[Object(b.jsx)(s.a,{id:"pending",type:"switch",name:"pending",innerRef:t.register()}),Object(b.jsx)(o.a,{className:"mb-0 font-medium-1",for:"pending",children:Object(b.jsx)("strong",{children:"Pending"})})]}),(O||!n)&&Object(b.jsx)("div",{className:"d-flex justify-content-between mt-1",children:Object(b.jsx)(u.a,{style:{width:"100%"},children:Object(b.jsx)(d.a,{control:t.control,defaultValue:null,name:"tax_exempt_id",render:function(e){var n=e.onChange,a=e.value;e.name,e.ref;return Object(b.jsx)(m.a,{isClearable:!0,className:"react-select",classNamePrefix:"select",isDisabled:r||f,defaultOptions:!0,value:{value:a,label:y(v)},loadOptions:w,onChange:function(e,r){n(null===e||void 0===e?void 0:e.item.id),function(e,n){var r,a;n.action,n.removedValue,console.log(null===e||void 0===e?void 0:e.item),x(null===e||void 0===e?void 0:e.item),(null===e||void 0===e?void 0:e.item)&&(t.setValue("customer.name",e.item.name),t.setValue("customer.email",e.item.email),t.setValue("identity_number_type",e.item.identity_number_type),t.setValue("customer_identity_number",e.item.identity_number),t.setValue("options.tax_exempt",null===(r=e.item)||void 0===r?void 0:r.tax_exempt),t.setValue("options.tax_zero",null===(a=e.item)||void 0===a?void 0:a.tax_zero))}(e,r)}})}})})})]})}},554:function(e,t,n){"use strict";var r=n(2),a=n(64),i=n.n(a),c=n(65),s=n(8),o=n(952),u=n(955),l=n(943),d=n(55),m=n(414),p=n(404),b=n(405),f=n(354),j=n(301),h=n(406),v=n(111),x=n(0),O=n(22),g=n(169),y=n(69),w=n(320),_=n(3);t.a=function(e){var t,n,a,N=e.form,C=e.updateWithStatus,S=e.updateStatus,k=e.order,V=e.isMigrated,F=e.onCompleteWithData,E=e.calculations,P=e.transactions,R=(JSON.parse(localStorage.getItem("user")),Object(x.useState)(null)),A=Object(s.a)(R,2),T=A[0],D=A[1],M=Object(x.useState)(!1),z=Object(s.a)(M,2),q=z[0],I=z[1],B=Object(x.useState)({payment_method:"",amount:"",shipping:"",commission:""}),J=Object(s.a)(B,2),W=J[0],G=J[1],L=Object(x.useState)([]),U=Object(s.a)(L,2),Y=U[0],H=U[1],K=Object(x.useState)(null),Q=Object(s.a)(K,2),X=(Q[0],Q[1]),Z=Object(x.useState)(!1),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ne=(null===E||void 0===E?void 0:E.total)||(null===k||void 0===k?void 0:k.total)||0,re=P.reduce((function(e,t){return e+parseFloat(t.amount||0)}),0),ae=N.watch("shipping.free"),ie=(ae&&(null===k||void 0===k||null===(t=k.shipping)||void 0===t||t.cost),ne-re-(ae?0:(null===k||void 0===k||null===(n=k.shipping)||void 0===n?void 0:n.cost)||0)),ce=Math.max(0,ie.toFixed(3));Object(x.useEffect)((function(){(function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.a.index();case 3:t=e.sent,console.log("Payment methods:",t),H(t||[]),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch payment methods:",e.t0),O.b.error("Failed to load payment methods");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var se=function(e,t){if(!e||!t)return 0;var n=Y.find((function(t){return t.id.toString()===e.toString()}));if(!n)return 0;var r=parseFloat(t);if(isNaN(r))return 0;switch(console.log("Calculating commission for:",{paymentMethod:n,amount:r,type:n.commission_type}),n.commission_type){case"Fixed":return parseFloat(n.commission)||0;case"Percent":var a=parseFloat(n.commission)||0;return r*a/100;case"Range":if(!n.commission_range)return 0;try{var i="string"===typeof n.commission_range?JSON.parse(n.commission_range):n.commission_range;if(!Array.isArray(i))return 0;var c=i.find((function(e){var t=parseFloat(e.from)||0,n=parseFloat(e.to)||1/0;return r>=t&&r<=n}));return c&&parseFloat(c.commission)||0}catch(s){return console.error("Error parsing commission_range:",s),0}default:return 0}};Object(x.useEffect)((function(){if(!ee&&W.payment_method&&W.amount){var e=se(W.payment_method,W.amount);G((function(t){return Object(r.a)(Object(r.a)({},t),{},{commission:e.toFixed(3)})}))}}),[W.payment_method,W.amount,Y,ee]),Object(x.useEffect)((function(){if(q&&k){var e,t,n=Y.find((function(e){return 1===e.id}))||Y[0],a=N.watch("shipping.free")&&(null===(e=k.shipping)||void 0===e?void 0:e.cost)||0,i={payment_method:n?n.id.toString():(null===(t=Y[0])||void 0===t?void 0:t.id.toString())||"",amount:ce>0?ce.toFixed(3):"0",shipping:a.toString(),commission:"0"};if(G(i),te(!1),n&&ce>0){var c=se(n.id.toString(),ce.toString());G((function(e){return Object(r.a)(Object(r.a)({},e),{},{commission:c.toFixed(3)})}))}}}),[q,k,Y,ce]),Object(x.useEffect)((function(){T||D(null===k||void 0===k?void 0:k.status)}),[k]);var oe=[{label:"New Order",value:"PENDING"},{label:"Processing",value:"PROCESSING"},{label:"Completed",value:"COMPLETED"}],ue=function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("COMPLETED"!==T){e.next=3;break}return I(!0),e.abrupt("return");case 3:Object(g.a)(Object(c.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C({status:T});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),O.b.error(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=Object(c.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W.payment_method&&W.amount){e.next=3;break}return O.b.error("Payment method and amount are required"),e.abrupt("return");case 3:if(!(parseFloat(W.amount)<0)){e.next=6;break}return O.b.error("Amount must be greater than 0"),e.abrupt("return");case 6:if(console.log(parseFloat(W.amount)),console.log(ie.toFixed(3)),!(parseFloat(W.amount)>ie.toFixed(3))){e.next=11;break}return O.b.error("Amount cannot exceed remaining balance of ".concat(ie.toFixed(3))),e.abrupt("return");case 11:return e.prev=11,e.next=14,F(W);case 14:I(!1),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),O.b.error(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 20:case"end":return e.stop()}}),e,null,[[11,17]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(g.b)(Object(c.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S({status:"CANCELED"});case 3:O.b.success("Success"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),O.b.error(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=W.payment_method?Y.find((function(e){return e.id.toString()===W.payment_method.toString()})):null;return Object(_.jsx)(o.a,{className:"invoice-action-wrapper",children:Object(_.jsxs)(u.a,{children:[Object(_.jsx)(l.a,{children:Object(_.jsx)(y.a,{control:N.control,defaultValue:null,name:"status",render:function(e){var t=e.onChange,n=e.value;e.name,e.ref;return Object(_.jsx)(v.a,{className:"react-select",classNamePrefix:"select",value:oe.filter((function(e){return e.value===(n||(null===k||void 0===k?void 0:k.status))})),options:oe,onChange:function(e){var n;t((null===e||void 0===e?void 0:e.value)||null),n=e,N.setValue("status",(null===n||void 0===n?void 0:n.value)||null),D(null===n||void 0===n?void 0:n.value)}})}})}),Object(_.jsx)(d.a.Ripple,{color:"primary",block:!0,onClick:ue,children:"Update Status"}),"PENDING"===(null===k||void 0===k?void 0:k.status)&&!V&&!(null===k||void 0===k||null===(a=k.options)||void 0===a?void 0:a.taxed)&&Object(_.jsx)(d.a.Ripple,{color:"danger",outline:!0,className:"mt-1",block:!0,onClick:de,children:"Delete Order"}),Object(_.jsxs)(m.a,{isOpen:q,toggle:function(){return I(!1)},children:[Object(_.jsx)(p.a,{toggle:function(){return I(!1)},children:"Complete Order"}),Object(_.jsxs)(b.a,{children:[Object(_.jsxs)("div",{className:"alert alert-info",children:[Object(_.jsx)("strong",{children:"Order Total:"})," ",ne,Object(_.jsx)("br",{}),Object(_.jsx)("strong",{children:"Existing Payments:"})," ",re.toFixed(3),Object(_.jsx)("br",{}),Object(_.jsx)("strong",{children:"Remaining Balance:"})," ",ie.toFixed(3),Object(_.jsx)("br",{}),Object(_.jsx)("strong",{children:"Maximum Payment Allowed:"})," ",ce.toFixed(3)]}),Object(_.jsx)("p",{children:"Are you sure you want to mark this order as COMPLETED?"}),Object(_.jsxs)(l.a,{children:[Object(_.jsx)(f.a,{for:"payment_method",children:"Payment Method *"}),Object(_.jsxs)(j.a,{type:"select",id:"payment_method",value:W.payment_method,onChange:function(e){return function(e){var t=Y.find((function(t){return t.id.toString()===e.toString()}));X(t),G((function(t){return Object(r.a)(Object(r.a)({},t),{},{payment_method:e})})),te(!1)}(e.target.value)},required:!0,children:[Object(_.jsx)("option",{value:"",children:"Select Payment Method"}),Y.map((function(e){return Object(_.jsxs)("option",{value:e.id,children:[e.name," (",e.commission_type,")"]},e.id)}))]}),me&&Object(_.jsxs)("small",{className:"text-muted",children:["Type: ",me.commission_type,"Fixed"===me.commission_type&&" - ".concat(me.commission," fixed"),"Percent"===me.commission_type&&" - ".concat(me.commission,"%"),"Range"===me.commission_type&&" - Based on amount ranges"]})]}),Object(_.jsxs)(l.a,{children:[Object(_.jsx)(f.a,{for:"amount",children:"Amount *"}),Object(_.jsx)(j.a,{type:"number",id:"amount",step:"0.001",min:"0",max:ce,value:W.amount,onChange:function(e){return function(e){var t=parseFloat(e)||0,n=Math.min(t,ce);G((function(e){return Object(r.a)(Object(r.a)({},e),{},{amount:n.toString()})})),te(!1)}(e.target.value)},required:!0}),Object(_.jsxs)("small",{className:"text-muted",children:["Maximum allowed: ",ce.toFixed(3)," (Remaining balance after existing payments)"]})]}),Object(_.jsxs)(l.a,{children:[Object(_.jsx)(f.a,{for:"shipping",children:"Shipping"}),Object(_.jsx)(j.a,{type:"number",id:"shipping",step:"0.001",min:"0",value:W.shipping,onChange:function(e){return G((function(t){return Object(r.a)(Object(r.a)({},t),{},{shipping:e.target.value})}))}})]}),Object(_.jsxs)(l.a,{children:[Object(_.jsxs)(f.a,{for:"commission",children:["Commission ",ee&&Object(_.jsx)("span",{className:"text-warning",children:"(Manual)"})]}),Object(_.jsxs)("div",{className:"d-flex",children:[Object(_.jsx)(j.a,{type:"number",id:"commission",step:"0.001",min:"0",value:W.commission,onChange:function(e){return t=e.target.value,G((function(e){return Object(r.a)(Object(r.a)({},e),{},{commission:t})})),void te(!0);var t},style:{borderColor:ee?"#ffc107":""}}),ee&&Object(_.jsx)(d.a,{color:"secondary",outline:!0,size:"sm",className:"ms-2",onClick:function(){if(W.payment_method&&W.amount){var e=se(W.payment_method,W.amount);G((function(t){return Object(r.a)(Object(r.a)({},t),{},{commission:e.toFixed(3)})})),te(!1)}},title:"Recalculate commission based on payment method and amount",children:"Auto"})]}),Object(_.jsx)("small",{className:"text-muted",children:ee?"Commission is manually set. Click 'Auto' to recalculate based on payment method.":"Commission is auto-calculated based on payment method and amount."})]}),me&&W.amount&&Object(_.jsx)("div",{className:"mt-2 p-2 border rounded",style:{backgroundColor:"#e9ecef"},children:Object(_.jsxs)("small",{children:[Object(_.jsx)("strong",{children:"Commission Calculation:"}),Object(_.jsx)("br",{}),"Payment Method: ",me.name,Object(_.jsx)("br",{}),"Type: ",me.commission_type,Object(_.jsx)("br",{}),"Amount: ",W.amount,Object(_.jsx)("br",{}),"Fixed"===me.commission_type&&"Fixed Commission: ".concat(me.commission),"Percent"===me.commission_type&&"Percentage: ".concat(me.commission,"%"),"Range"===me.commission_type&&"Commission based on matching range",ee&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("br",{}),Object(_.jsx)("strong",{children:"Currently manually overridden"})]})]})})]}),Object(_.jsxs)(h.a,{children:[Object(_.jsx)(d.a,{color:"secondary",onClick:function(){return I(!1)},children:"Cancel"}),Object(_.jsx)(d.a,{color:"primary",onClick:le,children:"Yes, Complete Order"})]})]})]})})}},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return b}));var r=n(64),a=n.n(r),i=n(65),c=n(85),s=n(77),o=function(e){return s.a.get(e).then((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.data}))},u={create:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post(t,n);case 2:return r=e.sent,i=r.data,e.abrupt("return",null===i||void 0===i?void 0:i.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.put("".concat(t,"/").concat(n),r);case 2:return i=e.sent,c=i.data,e.abrupt("return",null===c||void 0===c?void 0:c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),delete:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.delete("".concat(t,"/").concat(n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};function l(e,t){var n=Object(c.a)("".concat(e,"/").concat(t),o),r=n.data,s=n.mutate,l=n.error;return{loading:!r&&!l,error:l,data:r,mutate:s,update:function(){var n=Object(i.a)(a.a.mark((function n(r){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.update(e,t,r);case 2:return n.next=4,s();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}function d(e){var t=Object(c.a)(e,o,{revalidateOnFocus:!1,revalidateOnReconnect:!1,refreshWhenOffline:!1,refreshWhenHidden:!1,refreshInterval:0}),n=t.data,r=t.mutate,s=t.error;return{loading:!n&&!s,error:s,data:n||[],mutate:r,create:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.create(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}function m(e,t,n){var r=n.page,s=n.limit,l=n.search,d=n.order,m=void 0===d?{}:d,p=n.conditions,b=void 0===p?{}:p,f="".concat(t,"?page=").concat(r,"&limit=").concat(s,"&search=").concat(l,"&order=").concat(JSON.stringify(m),"&conditions=").concat(JSON.stringify(b)),j=Object(c.a)(f,o),h=j.data,v=j.mutate,x=j.error;return{loading:!h&&!x,error:x,data:(null===h||void 0===h?void 0:h.items)||[],total:(null===h||void 0===h?void 0:h.total)||0,mutate:v,mutates:{delete:function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.delete(e,n);case 2:return t.next=4,v(f);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}}function p(e,t,n){var r=n.page,s=n.limit,l=n.search,d=n.order,m=void 0===d?{}:d,p=n.conditions,b=void 0===p?{}:p,f=n.from,j=n.to,h="".concat(t,"?page=").concat(r,"&limit=").concat(s,"&from=").concat(f,"&to=").concat(j,"&search=").concat(l,"&order=").concat(JSON.stringify(m),"&conditions=").concat(JSON.stringify(b)),v=Object(c.a)(h,o),x=v.data,O=v.mutate,g=v.error;return{loading:!x&&!g,error:g,data:(null===x||void 0===x?void 0:x.items)||[],total:(null===x||void 0===x?void 0:x.total)||0,mutate:O,mutates:{delete:function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.delete(e,n);case 2:return t.next=4,O(h);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}}function b(e,t){var n=t.conditions,r="".concat(e,"?conditions=").concat(JSON.stringify(n)),a=Object(c.a)(r,o),i=a.data,s=a.mutate,u=a.error;return{loading:!i&&!u,error:u,data:(null===i||void 0===i?void 0:i.items)||[],total:(null===i||void 0===i?void 0:i.total)||0,mutate:s}}},84:function(e,t,n){"use strict";var r=n(76),a=n(172),i=n(173),c=n(3);t.a=function(e){var t=e.breadCrumbTitle,n=e.breadCrumbParent,s=e.breadCrumbParent2,o=e.breadCrumbParent3,u=e.breadCrumbActive,l=e.right;return Object(c.jsxs)("div",{className:"content-header row",children:[Object(c.jsx)("div",{className:"content-header-left col-9 mb-2",children:Object(c.jsx)("div",{className:"row breadcrumbs-top",children:Object(c.jsxs)("div",{className:"col-12",children:[t?Object(c.jsx)("h2",{className:"content-header-title float-left mb-0",children:t}):"",Object(c.jsx)("div",{className:"breadcrumb-wrapper vs-breadcrumbs d-sm-block d-none col-12",children:Object(c.jsxs)(a.a,{children:[Object(c.jsx)(i.a,{tag:"li",children:Object(c.jsx)(r.b,{to:"/",children:"Home"})}),n&&Object(c.jsx)(i.a,{tag:"li",className:"text-primary",children:n}),s?Object(c.jsx)(i.a,{tag:"li",className:"text-primary",children:s}):"",o?Object(c.jsx)(i.a,{tag:"li",className:"text-primary",children:o}):"",Object(c.jsx)(i.a,{tag:"li",active:!0,children:u})]})})]})})}),l?Object(c.jsx)("div",{className:"content-header-right text-md-right col-3",children:Object(c.jsx)("div",{className:"form-group breadcrum-right dropdown",children:l})}):""]})}}}]);
//# sourceMappingURL=164.6e7764d5.chunk.js.map